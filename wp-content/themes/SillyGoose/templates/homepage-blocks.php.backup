<?php
/**
 * Homepage Custom Blocks
 * Save as: templates/homepage-blocks.php
 */

// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}

// Register Custom Block Category
function sillygoose_register_block_category() {
    add_filter('block_categories_all', function($categories) {
        return array_merge(
            array(
                array(
                    'slug'  => 'sillygoose',
                    'title' => __('Silly Goose', 'sillygoose'),
                    'icon'  => null,
                ),
            ),
            $categories
        );
    });
}
add_action('init', 'sillygoose_register_block_category');

/**
 * Statistics Block
 */
function sillygoose_register_statistics_block() {
    register_block_type('sillygoose/statistics', array(
        'render_callback' => 'sillygoose_render_statistics_block',
        'attributes' => array(
            'happyClients' => array(
                'type' => 'string',
                'default' => '200',
            ),
            'projectsDelivered' => array(
                'type' => 'string',
                'default' => '500',
            ),
            'awardsWon' => array(
                'type' => 'string',
                'default' => '50',
            ),
            'support' => array(
                'type' => 'string',
                'default' => '24/7',
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_statistics_block');

function sillygoose_render_statistics_block($attributes) {
    $happy_clients = $attributes['happyClients'];
    $projects_delivered = $attributes['projectsDelivered'];
    $awards_won = $attributes['awardsWon'];
    $support = $attributes['support'];
    
    ob_start();
    ?>
    <div class="statistics-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; margin: 3rem auto; max-width: 64rem;">
        <div class="stat-item" style="text-align: center;">
            <div class="stat-number" style="font-size: 3rem; font-weight: 900; color: var(--primary); margin-bottom: 0.5rem;"><?php echo esc_html($happy_clients); ?>+</div>
            <div class="stat-label" style="color: var(--muted-foreground); font-size: 0.875rem;">Happy Clients</div>
        </div>
        <div class="stat-item" style="text-align: center;">
            <div class="stat-number" style="font-size: 3rem; font-weight: 900; color: var(--secondary); margin-bottom: 0.5rem;"><?php echo esc_html($projects_delivered); ?>+</div>
            <div class="stat-label" style="color: var(--muted-foreground); font-size: 0.875rem;">Projects Delivered</div>
        </div>
        <div class="stat-item" style="text-align: center;">
            <div class="stat-number" style="font-size: 3rem; font-weight: 900; color: var(--accent); margin-bottom: 0.5rem;"><?php echo esc_html($awards_won); ?>+</div>
            <div class="stat-label" style="color: var(--muted-foreground); font-size: 0.875rem;">Awards Won</div>
        </div>
        <div class="stat-item" style="text-align: center;">
            <div class="stat-number" style="font-size: 3rem; font-weight: 900; color: var(--primary); margin-bottom: 0.5rem;"><?php echo esc_html($support); ?></div>
            <div class="stat-label" style="color: var(--muted-foreground); font-size: 0.875rem;">Support</div>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * About Stats Block
 */
function sillygoose_register_about_stats_block() {
    register_block_type('sillygoose/about-stats', array(
        'render_callback' => 'sillygoose_render_about_stats_block',
        'attributes' => array(
            'teamMembers' => array(
                'type' => 'string',
                'default' => '25',
            ),
            'coffeeCups' => array(
                'type' => 'string',
                'default' => '9,847',
            ),
            'industryAwards' => array(
                'type' => 'string',
                'default' => '50',
            ),
            'clientLove' => array(
                'type' => 'string',
                'default' => '∞',
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_about_stats_block');

function sillygoose_render_about_stats_block($attributes) {
    $team_members = $attributes['teamMembers'];
    $coffee_cups = $attributes['coffeeCups'];
    $industry_awards = $attributes['industryAwards'];
    $client_love = $attributes['clientLove'];
    
    ob_start();
    ?>
    <div class="about-stats-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin: 3rem 0;">
        <div class="about-stat-item" style="display: flex; align-items: center; gap: 0.75rem;">
            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/></svg>
            </div>
            <div>
                <div style="font-weight: 700;"><?php echo esc_html($team_members); ?>+</div>
                <div style="font-size: 0.875rem; color: var(--muted-foreground);">Team Members</div>
            </div>
        </div>
        <div class="about-stat-item" style="display: flex; align-items: center; gap: 0.75rem;">
            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            </div>
            <div>
                <div style="font-weight: 700;"><?php echo esc_html($coffee_cups); ?></div>
                <div style="font-size: 0.875rem; color: var(--muted-foreground);">Cups of Coffee</div>
            </div>
        </div>
        <div class="about-stat-item" style="display: flex; align-items: center; gap: 0.75rem;">
            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>
            </div>
            <div>
                <div style="font-weight: 700;"><?php echo esc_html($industry_awards); ?>+</div>
                <div style="font-size: 0.875rem; color: var(--muted-foreground);">Industry Awards</div>
            </div>
        </div>
        <div class="about-stat-item" style="display: flex; align-items: center; gap: 0.75rem;">
            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
            </div>
            <div>
                <div style="font-weight: 700;"><?php echo esc_html($client_love); ?></div>
                <div style="font-size: 0.875rem; color: var(--muted-foreground);">Client Love</div>
            </div>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Services Grid Block (displays from custom post type)
 */
function sillygoose_register_services_block() {
    register_block_type('sillygoose/services-grid', array(
        'render_callback' => 'sillygoose_render_services_block',
        'attributes' => array(
            'postsToShow' => array(
                'type' => 'number',
                'default' => 6,
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_services_block');

function sillygoose_render_services_block($attributes) {
    $posts_to_show = isset($attributes['postsToShow']) ? $attributes['postsToShow'] : 6;
    
    // Try to get services from custom post type first
    $services_query = new WP_Query(array(
        'post_type' => 'service',
        'posts_per_page' => $posts_to_show,
        'post_status' => 'publish',
        'orderby' => 'menu_order',
        'order' => 'ASC',
    ));

    ob_start();
    ?>
    <div class="services-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin: 2rem 0;">
        <?php 
        if ($services_query->have_posts()) :
            while ($services_query->have_posts()) : $services_query->the_post();
                $icon = get_post_meta(get_the_ID(), '_service_icon', true) ?: 'zap';
                $price = get_post_meta(get_the_ID(), '_service_price', true);
                $timeline = get_post_meta(get_the_ID(), '_service_timeline', true);
                $features = get_post_meta(get_the_ID(), '_service_features', true);
                $features_array = $features ? explode("\n", $features) : array();
        ?>
            <div class="service-card card" style="background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.5rem; transition: all 0.3s ease;">
                <div style="display: inline-flex; padding: 0.75rem; border-radius: 50%; background: rgba(255, 107, 53, 0.1); color: var(--primary); margin-bottom: 1.5rem;">
                    <?php echo sillygoose_get_service_icon($icon); ?>
                </div>
                <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;"><?php the_title(); ?></h3>
                <div style="color: var(--muted-foreground); margin-bottom: 1.5rem; line-height: 1.6;">
                    <?php the_excerpt(); ?>
                </div>
                <?php if (!empty($features_array)) : ?>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 1.5rem;">
                        <?php foreach ($features_array as $feature): ?>
                            <div style="display: flex; align-items: center; font-size: 0.875rem;">
                                <div style="width: 0.5rem; height: 0.5rem; background: var(--primary); border-radius: 50%; margin-right: 0.75rem;"></div>
                                <span style="color: var(--muted-foreground);"><?php echo esc_html(trim($feature)); ?></span>
                            </div>
                        <?php endforeach; ?>
                    </div>
                <?php endif; ?>
                <?php if ($price || $timeline) : ?>
                    <div style="margin-top: auto; padding-top: 1rem; border-top: 1px solid var(--border); font-size: 0.875rem; color: var(--muted-foreground);">
                        <?php if ($price) : ?>
                            <div>From £<?php echo number_format($price); ?></div>
                        <?php endif; ?>
                        <?php if ($timeline) : ?>
                            <div><?php echo esc_html($timeline); ?></div>
                        <?php endif; ?>
                    </div>
                <?php endif; ?>
            </div>
        <?php 
            endwhile;
            wp_reset_postdata();
        else :
            // Fallback to hardcoded services if no custom posts exist
            $fallback_services = array(
                array(
                    'icon' => 'palette',
                    'title' => 'Web Design',
                    'description' => 'Stunning, user-friendly designs that make your competitors weep tears of envy.',
                    'features' => array('UI/UX Design', 'Responsive Design', 'Brand Identity', 'Prototyping'),
                ),
                array(
                    'icon' => 'code',
                    'title' => 'Web Development',
                    'description' => 'Rock-solid code that\'s faster than your morning coffee kick and more reliable than your best mate.',
                    'features' => array('React & Next.js', 'E-commerce', 'CMS Integration', 'API Development'),
                ),
                array(
                    'icon' => 'search',
                    'title' => 'SEO',
                    'description' => 'We\'ll get you to the top of Google faster than you can say \'search engine optimisation\'.',
                    'features' => array('Technical SEO', 'Content Strategy', 'Local SEO', 'Performance Monitoring'),
                ),
            );

            foreach ($fallback_services as $service) : ?>
                <div class="service-card card" style="background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.5rem; transition: all 0.3s ease;">
                    <div style="display: inline-flex; padding: 0.75rem; border-radius: 50%; background: rgba(255, 107, 53, 0.1); color: var(--primary); margin-bottom: 1.5rem;">
                        <?php echo sillygoose_get_service_icon($service['icon']); ?>
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;"><?php echo esc_html($service['title']); ?></h3>
                    <p style="color: var(--muted-foreground); margin-bottom: 1.5rem; line-height: 1.6;"><?php echo esc_html($service['description']); ?></p>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <?php foreach ($service['features'] as $feature): ?>
                            <div style="display: flex; align-items: center; font-size: 0.875rem;">
                                <div style="width: 0.5rem; height: 0.5rem; background: var(--primary); border-radius: 50%; margin-right: 0.75rem;"></div>
                                <span style="color: var(--muted-foreground);"><?php echo esc_html($feature); ?></span>
                            </div>
                        <?php endforeach; ?>
                    </div>
                </div>
            <?php endforeach;
        endif; ?>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Projects Grid Block
 */
function sillygoose_register_projects_block() {
    register_block_type('sillygoose/projects-grid', array(
        'render_callback' => 'sillygoose_render_projects_block',
        'attributes' => array(
            'postsToShow' => array(
                'type' => 'number',
                'default' => 6,
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_projects_block');

function sillygoose_render_projects_block($attributes) {
    $posts_to_show = isset($attributes['postsToShow']) ? $attributes['postsToShow'] : 6;
    
    $projects_query = new WP_Query(array(
        'post_type' => 'project',
        'posts_per_page' => $posts_to_show,
        'post_status' => 'publish',
    ));

    if (!$projects_query->have_posts()) {
        return '<p style="text-align: center; color: var(--muted-foreground);">No projects found. Add some projects to display them here.</p>';
    }

    ob_start();
    ?>
    <div class="projects-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin: 2rem 0;">
        <?php while ($projects_query->have_posts()) : $projects_query->the_post();
            $client = get_post_meta(get_the_ID(), '_project_client', true);
            $url = get_post_meta(get_the_ID(), '_project_url', true);
            $result = get_post_meta(get_the_ID(), '_project_result', true);
            $technologies = get_post_meta(get_the_ID(), '_project_technologies', true);
            $tech_array = $technologies ? explode(',', $technologies) : array();
        ?>
            <div class="project-card card" style="overflow: hidden;">
                <?php if (has_post_thumbnail()) : ?>
                    <div style="position: relative; overflow: hidden;">
                        <?php the_post_thumbnail('large', array('style' => 'width: 100%; height: 200px; object-fit: cover;')); ?>
                        <?php
                        $terms = get_the_terms(get_the_ID(), 'service_type');
                        if ($terms && !is_wp_error($terms)) :
                        ?>
                            <div style="position: absolute; top: 1rem; right: 1rem;">
                                <span style="background: rgba(255, 255, 255, 0.9); padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500;">
                                    <?php echo esc_html($terms[0]->name); ?>
                                </span>
                            </div>
                        <?php endif; ?>
                    </div>
                <?php endif; ?>
                
                <div style="padding: 1.5rem;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;"><?php the_title(); ?></h3>
                    
                    <?php if ($client) : ?>
                        <p style="color: var(--muted-foreground); font-size: 0.875rem; margin-bottom: 1rem;">
                            Client: <?php echo esc_html($client); ?>
                        </p>
                    <?php endif; ?>
                    
                    <div style="color: var(--muted-foreground); margin-bottom: 1rem; font-size: 0.875rem; line-height: 1.5;">
                        <?php the_excerpt(); ?>
                    </div>
                    
                    <?php if (!empty($tech_array)) : ?>
                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem;">
                            <?php foreach ($tech_array as $tech): ?>
                                <span style="background: var(--muted); color: var(--muted-foreground); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">
                                    <?php echo esc_html(trim($tech)); ?>
                                </span>
                            <?php endforeach; ?>
                        </div>
                    <?php endif; ?>
                    
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-top: auto;">
                        <?php if ($result) : ?>
                            <div style="font-size: 0.875rem;">
                                <span style="color: var(--muted-foreground);">Result: </span>
                                <span style="font-weight: 500; color: var(--primary);"><?php echo esc_html($result); ?></span>
                            </div>
                        <?php endif; ?>
                        <?php if ($url) : ?>
                            <a href="<?php echo esc_url($url); ?>" target="_blank" rel="noopener noreferrer" style="color: var(--muted-foreground); text-decoration: none; transition: color 0.3s ease;" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted-foreground)'">
                                <svg style="width: 1rem; height: 1rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                                </svg>
                            </a>
                        <?php endif; ?>
                    </div>
                </div>
            </div>
        <?php endwhile; wp_reset_postdata(); ?>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Testimonials Block
 */
function sillygoose_register_testimonials_block() {
    register_block_type('sillygoose/testimonials', array(
        'render_callback' => 'sillygoose_render_testimonials_block',
        'attributes' => array(
            'postsToShow' => array(
                'type' => 'number',
                'default' => 3,
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_testimonials_block');

function sillygoose_render_testimonials_block($attributes) {
    $posts_to_show = isset($attributes['postsToShow']) ? $attributes['postsToShow'] : 3;
    
    $testimonials_query = new WP_Query(array(
        'post_type' => 'testimonial',
        'posts_per_page' => $posts_to_show,
        'post_status' => 'publish',
    ));

    if (!$testimonials_query->have_posts()) {
        return '<p style="text-align: center; color: var(--muted-foreground);">No testimonials found. Add some testimonials to display them here.</p>';
    }

    ob_start();
    ?>
    <div class="testimonials-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin: 2rem 0;">
        <?php while ($testimonials_query->have_posts()) : $testimonials_query->the_post();
            $client_name = get_post_meta(get_the_ID(), '_client_name', true);
            $client_position = get_post_meta(get_the_ID(), '_client_position', true);
            $client_company = get_post_meta(get_the_ID(), '_client_company', true);
            $rating = get_post_meta(get_the_ID(), '_rating', true) ?: 5;
        ?>
            <div class="testimonial-card card" style="background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 2rem; position: relative;">
                <!-- Quote Icon -->
                <div style="position: absolute; top: 1rem; right: 1rem; color: var(--primary); opacity: 0.2;">
                    <svg style="width: 2rem; height: 2rem;" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h4v10h-10z"/>
                    </svg>
                </div>
                
                <!-- Rating Stars -->
                <div style="display: flex; gap: 0.25rem; margin-bottom: 1rem;">
                    <?php for ($i = 1; $i <= 5; $i++) : ?>
                        <svg style="width: 1rem; height: 1rem; color: <?php echo $i <= $rating ? 'var(--accent)' : 'var(--border)'; ?>;" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                    <?php endfor; ?>
                </div>
                
                <!-- Testimonial Content -->
                <div style="color: var(--muted-foreground); font-style: italic; line-height: 1.6; margin-bottom: 1.5rem;">
                    "<?php the_content(); ?>"
                </div>
                
                <!-- Client Info -->
                <div style="border-top: 1px solid var(--border); padding-top: 1rem;">
                    <?php if (has_post_thumbnail()) : ?>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <?php the_post_thumbnail('thumbnail', array('style' => 'width: 3rem; height: 3rem; border-radius: 50%; object-fit: cover;')); ?>
                            <div>
                                <div style="font-weight: 600; color: var(--foreground);"><?php echo esc_html($client_name ?: get_the_title()); ?></div>
                                <?php if ($client_position || $client_company) : ?>
                                    <div style="font-size: 0.875rem; color: var(--muted-foreground);">
                                        <?php 
                                        $position_company = array();
                                        if ($client_position) $position_company[] = $client_position;
                                        if ($client_company) $position_company[] = $client_company;
                                        echo esc_html(implode(' at ', $position_company));
                                        ?>
                                    </div>
                                <?php endif; ?>
                            </div>
                        </div>
                    <?php else : ?>
                        <div>
                            <div style="font-weight: 600; color: var(--foreground);"><?php echo esc_html($client_name ?: get_the_title()); ?></div>
                            <?php if ($client_position || $client_company) : ?>
                                <div style="font-size: 0.875rem; color: var(--muted-foreground);">
                                    <?php 
                                    $position_company = array();
                                    if ($client_position) $position_company[] = $client_position;
                                    if ($client_company) $position_company[] = $client_company;
                                    echo esc_html(implode(' at ', $position_company));
                                    ?>
                                </div>
                            <?php endif; ?>
                        </div>
                    <?php endif; ?>
                </div>
            </div>
        <?php endwhile; wp_reset_postdata(); ?>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Contact Form Block
 */
function sillygoose_register_contact_form_block() {
    register_block_type('sillygoose/contact-form', array(
        'render_callback' => 'sillygoose_render_contact_form_block',
        'attributes' => array(
            'showContactInfo' => array(
                'type' => 'boolean',
                'default' => true,
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_contact_form_block');

function sillygoose_render_contact_form_block($attributes) {
    $show_contact_info = isset($attributes['showContactInfo']) ? $attributes['showContactInfo'] : true;
    
    ob_start();
    ?>
    <div class="contact-block" style="background: linear-gradient(135deg, rgba(255, 107, 53, 0.05), rgba(78, 205, 196, 0.05), rgba(255, 210, 63, 0.05)); padding: 3rem 0; border-radius: var(--radius);">
        <div class="container">
            <div style="display: grid; grid-template-columns: <?php echo $show_contact_info ? '1fr 2fr' : '1fr'; ?>; gap: 3rem; align-items: start;">
                
                <?php if ($show_contact_info) : ?>
                <!-- Contact Info -->
                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <h3 style="font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem;">
                        Let's Connect
                    </h3>
                    
                    <!-- Email -->
                    <div class="card" style="padding: 1.5rem;">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">Email</div>
                                <a href="mailto:<?php echo esc_attr(sillygoose_get_option('contact_email', 'hello@sillygoose.agency')); ?>" 
                                   style="color: var(--muted-foreground); text-decoration: none; transition: color 0.3s ease;"
                                   onmouseover="this.style.color='var(--primary)'"
                                   onmouseout="this.style.color='var(--muted-foreground)'">
                                    <?php echo esc_html(sillygoose_get_option('contact_email', 'hello@sillygoose.agency')); ?>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Phone -->
                    <div class="card" style="padding: 1.5rem;">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">Phone</div>
                                <a href="tel:+441752745596673" 
                                   style="color: var(--muted-foreground); text-decoration: none; transition: color 0.3s ease;"
                                   onmouseover="this.style.color='var(--primary)'"
                                   onmouseout="this.style.color='var(--muted-foreground)'">
                                    <?php echo esc_html(sillygoose_get_option('contact_phone', '+44 1752 SILLY-GOOSE')); ?>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Location -->
                    <div class="card" style="padding: 1.5rem;">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">Location</div>
                                <a href="https://maps.google.com/maps?q=Plymouth,UK" 
                                   style="color: var(--muted-foreground); text-decoration: none; transition: color 0.3s ease;"
                                   onmouseover="this.style.color='var(--primary)'"
                                   onmouseout="this.style.color='var(--muted-foreground)'"
                                   target="_blank" rel="noopener noreferrer">
                                    <?php echo esc_html(sillygoose_get_option('contact_location', 'Plymouth, UK')); ?>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Response Time -->
                    <div class="card" style="padding: 1.5rem;">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <div style="padding: 0.5rem; background: rgba(255, 107, 53, 0.1); border-radius: var(--radius); color: var(--primary);">
                                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">Response Time</div>
                                <div style="color: var(--muted-foreground);">Within 24 hours</div>
                            </div>
                        </div>
                    </div>
                </div>
                <?php endif; ?>

                <!-- Contact Form -->
                <div>
                    <div class="card" style="padding: 2rem;">
                        <form method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" style="display: flex; flex-direction: column; gap: 1.5rem;">
                            <input type="hidden" name="action" value="sillygoose_contact">
                            <?php wp_nonce_field('sillygoose_contact_form', 'sillygoose_contact_nonce'); ?>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div>
                                    <label for="contact_name" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">
                                        Name *
                                    </label>
                                    <input
                                        id="contact_name"
                                        name="contact_name"
                                        type="text"
                                        required
                                        placeholder="Your awesome name"
                                        class="form-input"
                                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--input-background);"
                                    />
                                </div>
                                
                                <div>
                                    <label for="contact_email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">
                                        Email *
                                    </label>
                                    <input
                                        id="contact_email"
                                        name="contact_email"
                                        type="email"
                                        required
                                        placeholder="your.email@example.com"
                                        class="form-input"
                                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--input-background);"
                                    />
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div>
                                    <label for="contact_project" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">
                                        Project Type
                                    </label>
                                    <select
                                        id="contact_project"
                                        name="contact_project"
                                        class="form-select"
                                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--input-background);"
                                    >
                                        <option value="">Select a project type</option>
                                        <option value="website">Website Design & Development</option>
                                        <option value="seo">SEO</option>
                                        <option value="ecommerce">E-commerce Store</option>
                                        <option value="paid-media">Paid Media Marketing</option>
                                        <option value="branding">Brand Strategy</option>
                                        <option value="other">Something Else Awesome</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="contact_budget" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">
                                        Budget Range
                                    </label>
                                    <select
                                        id="contact_budget"
                                        name="contact_budget"
                                        class="form-select"
                                        style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--input-background);"
                                    >
                                        <option value="">Select budget range</option>
                                        <option value="5k-10k">£5,000 - £10,000</option>
                                        <option value="10k-25k">£10,000 - £25,000</option>
                                        <option value="25k-50k">£25,000 - £50,000</option>
                                        <option value="50k+">£50,000+</option>
                                        <option value="discuss">Let's Discuss</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label for="contact_message" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">
                                    Tell us about your project *
                                </label>
                                <textarea
                                    id="contact_message"
                                    name="contact_message"
                                    required
                                    placeholder="Describe your project, goals, timeline, or anything else you'd like us to know. The more details, the better we can help!"
                                    rows="6"
                                    class="form-textarea"
                                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--input-background); resize: vertical; min-height: 120px;"
                                ></textarea>
                            </div>

                            <button 
                                type="submit" 
                                class="btn btn-primary btn-lg"
                                style="width: 100%; display: inline-flex; align-items: center; justify-content: center; padding: 1rem 2rem; background-color: var(--primary); color: var(--primary-foreground); border: none; border-radius: var(--radius); font-weight: 600; font-size: 1.125rem; cursor: pointer; transition: all 0.3s ease;"
                                onmouseover="this.style.backgroundColor='#e55a2b'; this.style.transform='translateY(-2px)'"
                                onmouseout="this.style.backgroundColor='var(--primary)'; this.style.transform='translateY(0)'"
                            >
                                Send Message
                                <svg style="width: 1.25rem; height: 1.25rem; margin-left: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Newsletter Signup Block
 */
function sillygoose_register_newsletter_block() {
    register_block_type('sillygoose/newsletter', array(
        'render_callback' => 'sillygoose_render_newsletter_block',
        'attributes' => array(
            'title' => array(
                'type' => 'string',
                'default' => 'Stay in the Loop',
            ),
            'description' => array(
                'type' => 'string',
                'default' => 'Get the latest design trends, development tips, and silly goose updates delivered straight to your inbox.',
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_newsletter_block');

function sillygoose_render_newsletter_block($attributes) {
    $title = $attributes['title'];
    $description = $attributes['description'];
    
    ob_start();
    ?>
    <div class="newsletter-block" style="text-align: center; padding: 3rem 2rem; background: var(--muted); border-radius: var(--radius); margin: 2rem 0;">
        <h3 style="font-size: 2rem; font-weight: 700; margin-bottom: 1rem;"><?php echo esc_html($title); ?></h3>
        <p style="color: var(--muted-foreground); margin-bottom: 2rem; max-width: 32rem; margin-left: auto; margin-right: auto;">
            <?php echo esc_html($description); ?>
        </p>
        <div style="max-width: 24rem; margin: 0 auto;">
            <form method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" style="display: flex; gap: 0.75rem; flex-direction: column;">
                <input type="hidden" name="action" value="sillygoose_newsletter">
                <?php wp_nonce_field('sillygoose_newsletter_form', 'sillygoose_newsletter_nonce'); ?>
                <div style="display: flex; gap: 0.75rem;">
                    <input
                        type="email"
                        name="newsletter_email"
                        placeholder="your.email@example.com"
                        class="form-input"
                        style="flex: 1; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--background);"
                        required
                    />
                    <button 
                        type="submit" 
                        class="btn btn-primary"
                        style="flex-shrink: 0; padding: 0.75rem 1.5rem; background-color: var(--primary); color: var(--primary-foreground); border: none; border-radius: var(--radius); font-weight: 600; cursor: pointer; transition: all 0.3s ease;"
                        onmouseover="this.style.backgroundColor='#e55a2b'"
                        onmouseout="this.style.backgroundColor='var(--primary)'"
                    >
                        Subscribe
                    </button>
                </div>
            </form>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Newsletter form handler
 */
function sillygoose_handle_newsletter_form() {
    if (isset($_POST['sillygoose_newsletter_nonce']) && wp_verify_nonce($_POST['sillygoose_newsletter_nonce'], 'sillygoose_newsletter_form')) {
        $email = sanitize_email($_POST['newsletter_email']);

        // Here you would typically add the email to your newsletter service
        // For now, we'll just send an admin notification
        $to = get_option('admin_email');
        $subject = 'New Newsletter Subscription';
        $body = "New newsletter subscription from: $email";
        $headers = array('Content-Type: text/plain; charset=UTF-8');
        
        if (wp_mail($to, $subject, $body, $headers)) {
            wp_redirect(add_query_arg('newsletter', 'success', wp_get_referer()));
            exit;
        } else {
            wp_redirect(add_query_arg('newsletter', 'error', wp_get_referer()));
            exit;
        }
    }
}
add_action('admin_post_nopriv_sillygoose_newsletter', 'sillygoose_handle_newsletter_form');
add_action('admin_post_sillygoose_newsletter', 'sillygoose_handle_newsletter_form');

/**
 * Helper function to get service icons
 */
function sillygoose_get_service_icon($icon) {
    $icons = array(
        'palette' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"/></svg>',
        'code' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--secondary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/></svg>',
        'search' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--accent);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>',
        'target' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>',
        'globe' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--secondary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>',
        'zap' => '<svg style="width: 1.5rem; height: 1.5rem; color: var(--accent);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>',
        'users' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/></svg>',
        'coffee' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
        'award' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>',
        'heart' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>',
        'mail' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>',
        'phone' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>',
        'map-pin' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>',
        'clock' => '<svg style="width: 1.25rem; height: 1.25rem; color: var(--primary);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
    );
    
    return isset($icons[$icon]) ? $icons[$icon] : '';
}

/**
 * Hero Section Block
 */
function sillygoose_register_hero_block() {
    register_block_type('sillygoose/hero', array(
        'render_callback' => 'sillygoose_render_hero_block',
        'attributes' => array(
            'title' => array(
                'type' => 'string',
                'default' => 'Silly Goose',
            ),
            'subtitle' => array(
                'type' => 'string',
                'default' => 'We\'re not going to be beaten by AI, we\'re making it our bitch.',
            ),
            'description' => array(
                'type' => 'string',
                'default' => 'A wickedly creative digital agency that turns your wildest ideas into jaw-dropping websites, apps, and marketing campaigns that actually work.',
            ),
            'showStats' => array(
                'type' => 'boolean',
                'default' => true,
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_hero_block');

function sillygoose_render_hero_block($attributes) {
    global $post;
    
    $title = $attributes['title'];
    $subtitle = $attributes['subtitle'];
    $description = $attributes['description'];
    $show_stats = $attributes['showStats'];
    
    // Get custom meta values
    $hero_bg_image = sillygoose_get_hero_bg_image();
    $hero_bg_overlay = sillygoose_get_hero_bg_overlay();
    $title_tag = sillygoose_get_title_tag();
    $subtitle_tag = sillygoose_get_subtitle_tag();
    
    // Use custom background image if available, otherwise use default
    $background_url = $hero_bg_image ?: 'https://images.unsplash.com/photo-1746309226522-f986af8bc6c5?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxjb2xvcmZ1bCUyMGdlb21ldHJpYyUyMHBhdHRlcm5zfGVufDF8fHx8MTc1ODMxNjM0OXww&ixlib=rb-4.1.0&q=80&w=1080';
    
    ob_start();
    ?>
    <section class="hero" style="min-height: 100vh; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; padding-top: 80px;">
        <!-- Background Pattern -->
        <div class="hero-bg" style="position: absolute; inset: 0; opacity: <?php echo esc_attr($hero_bg_overlay); ?>; background: url('<?php echo esc_url($background_url); ?>') center/cover;"></div>

        <!-- Floating Elements -->
        <div class="floating-element floating-1" style="position: absolute; top: 5rem; left: 2.5rem; width: 5rem; height: 5rem; background-color: var(--accent); border-radius: 50%; opacity: 0.6; animation: bounce 2s infinite;"></div>
        <div class="floating-element floating-2" style="position: absolute; top: 10rem; right: 5rem; width: 4rem; height: 4rem; background-color: var(--secondary); border-radius: 50%; opacity: 0.6; animation: bounce 2s infinite; animation-delay: 1s;"></div>
        <div class="floating-element floating-3" style="position: absolute; bottom: 10rem; left: 5rem; width: 3rem; height: 3rem; background-color: var(--primary); border-radius: 50%; opacity: 0.6; animation: bounce 2s infinite; animation-delay: 2s;"></div>
        <div class="floating-element floating-4" style="position: absolute; bottom: 5rem; right: 2.5rem; width: 6rem; height: 6rem; background-color: var(--accent); border-radius: 50%; opacity: 0.6; animation: bounce 2s infinite; animation-delay: 0.5s;"></div>

        <div class="container" style="text-align: center; position: relative; z-index: 10; padding: 0 1rem;">
            <div class="badge" style="display: inline-flex; align-items: center; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; border: 1px solid var(--border); background: var(--secondary-foreground); color: var(--secondary); margin-bottom: 2rem;">
                <svg style="width: 1rem; height: 1rem; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
                Making AI Our Bitch Since 2024
            </div>
            
            <<?php echo esc_html($title_tag); ?> class="gradient-text" style="font-size: clamp(3rem, 8vw, 8rem); background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: pulse 2s infinite; margin-bottom: 1.5rem;">
                <?php echo esc_html($title); ?>
            </<?php echo esc_html($title_tag); ?>>
            
            <div style="max-width: 64rem; margin: 0 auto; margin-bottom: 2rem;">
                <p style="font-size: clamp(1.5rem, 4vw, 3rem); margin-bottom: 1rem; font-weight: 700;">
                    We're not going to be beaten by AI,
                </p>
                <<?php echo esc_html($subtitle_tag); ?> style="font-size: clamp(1.5rem, 4vw, 3rem); font-weight: 700; color: var(--primary);">
                    <?php echo esc_html($subtitle); ?>
                </<?php echo esc_html($subtitle_tag); ?>>
            </div>
            
            <p style="font-size: 1.125rem; color: var(--muted-foreground); max-width: 32rem; margin: 0 auto; margin-bottom: 3rem;">
                <?php echo esc_html($description); ?>
            </p>
            
            <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; margin-bottom: 2rem; flex-direction: column;">
                <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                    <a href="#contact" class="btn btn-primary btn-lg" style="display: inline-flex; align-items: center; justify-content: center; padding: 1rem 2rem; border-radius: 9999px; background-color: var(--primary); color: var(--primary-foreground); text-decoration: none; font-weight: 600; font-size: 1.125rem; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#e55a2b'; this.style.transform='translateY(-2px)'" onmouseout="this.style.backgroundColor='var(--primary)'; this.style.transform='translateY(0)'">
                        Let's Get Silly
                        <svg style="width: 1.25rem; height: 1.25rem; margin-left: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </a>
                    <a href="#work" class="btn btn-outline btn-lg" style="display: inline-flex; align-items: center; justify-content: center; padding: 1rem 2rem; border-radius: 9999px; background-color: transparent; color: var(--primary); border: 2px solid var(--primary); text-decoration: none; font-weight: 600; font-size: 1.125rem; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='var(--primary)'; this.style.color='var(--primary-foreground)'" onmouseout="this.style.backgroundColor='transparent'; this.style.color='var(--primary)'">
                        See Our Work
                    </a>
                </div>
            </div>
            
            <?php if ($show_stats) : ?>
            <!-- Stats -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; margin-top: 5rem; max-width: 64rem; margin-left: auto; margin-right: auto;">
                <div style="text-align: center;">
                    <div style="font-size: 3rem; font-weight: 900; color: var(--primary); margin-bottom: 0.5rem;">200+</div>
                    <div style="color: var(--muted-foreground);">Happy Clients</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 3rem; font-weight: 900; color: var(--secondary); margin-bottom: 0.5rem;">500+</div>
                    <div style="color: var(--muted-foreground);">Projects Delivered</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 3rem; font-weight: 900; color: var(--accent); margin-bottom: 0.5rem;">50+</div>
                    <div style="color: var(--muted-foreground);">Awards Won</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 3rem; font-weight: 900; color: var(--primary); margin-bottom: 0.5rem;">24/7</div>
                    <div style="color: var(--muted-foreground);">Support</div>
                </div>
            </div>
            <?php endif; ?>
        </div>

        <style>
            @keyframes bounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-20px); }
            }
            @keyframes pulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.8; }
            }
            @media (max-width: 768px) {
                .floating-element { display: none; }
                .hero { padding-top: 100px; }
            }
        </style>
    </section>
    <?php
    return ob_get_clean();
}

/**
 * CTA (Call to Action) Block
 */
function sillygoose_register_cta_block() {
    register_block_type('sillygoose/cta', array(
        'render_callback' => 'sillygoose_render_cta_block',
        'attributes' => array(
            'title' => array(
                'type' => 'string',
                'default' => 'Ready to Make Magic Happen?',
            ),
            'description' => array(
                'type' => 'string',
                'default' => 'Let\'s turn your wildest ideas into digital reality. Drop us a line and let\'s chat about your next big project.',
            ),
            'buttonText' => array(
                'type' => 'string',
                'default' => 'Get Started Today',
            ),
            'buttonUrl' => array(
                'type' => 'string',
                'default' => '#contact',
            ),
            'backgroundColor' => array(
                'type' => 'string',
                'default' => 'gradient',
            ),
        ),
    ));
}
add_action('init', 'sillygoose_register_cta_block');

function sillygoose_render_cta_block($attributes) {
    $title = $attributes['title'];
    $description = $attributes['description'];
    $button_text = $attributes['buttonText'];
    $button_url = $attributes['buttonUrl'];
    $background = $attributes['backgroundColor'];
    
    $bg_style = '';
    if ($background === 'gradient') {
        $bg_style = 'background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(78, 205, 196, 0.1), rgba(255, 210, 63, 0.1));';
    } elseif ($background === 'primary') {
        $bg_style = 'background: var(--primary); color: white;';
    } elseif ($background === 'muted') {
        $bg_style = 'background: var(--muted);';
    }
    
    ob_start();
    ?>
    <div class="cta-block" style="padding: 4rem 2rem; text-align: center; border-radius: var(--radius); margin: 3rem 0; <?php echo $bg_style; ?>">
        <div class="container" style="max-width: 48rem; margin: 0 auto;">
            <h2 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 1.5rem; <?php echo $background === 'primary' ? 'color: white;' : ''; ?>">
                <?php echo esc_html($title); ?>
            </h2>
            <p style="font-size: 1.25rem; margin-bottom: 2rem; <?php echo $background === 'primary' ? 'color: rgba(255, 255, 255, 0.9);' : 'color: var(--muted-foreground);'; ?>">
                <?php echo esc_html($description); ?>
            </p>
            <a href="<?php echo esc_url($button_url); ?>" class="btn btn-primary btn-lg" style="display: inline-flex; align-items: center; justify-content: center; padding: 1rem 2rem; background-color: var(--primary); color: var(--primary-foreground); border: none; border-radius: var(--radius); font-weight: 600; font-size: 1.125rem; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#e55a2b'; this.style.transform='translateY(-2px)'" onmouseout="this.style.backgroundColor='var(--primary)'; this.style.transform='translateY(0)'">
                <?php echo esc_html($button_text); ?>
                <svg style="width: 1.25rem; height: 1.25rem; margin-left: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
            </a>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/**
 * Register all blocks
 */
function sillygoose_register_all_blocks() {
    sillygoose_register_statistics_block();
    sillygoose_register_about_stats_block();
    sillygoose_register_services_block();
    sillygoose_register_projects_block();
    sillygoose_register_testimonials_block();
    sillygoose_register_contact_form_block();
    sillygoose_register_newsletter_block();
    sillygoose_register_hero_block();
    sillygoose_register_cta_block();
}
add_action('init', 'sillygoose_register_all_blocks');